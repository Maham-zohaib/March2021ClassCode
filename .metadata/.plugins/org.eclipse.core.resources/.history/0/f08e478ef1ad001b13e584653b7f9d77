package testcasesNG;

import java.io.IOException;
import java.lang.reflect.Method;

import org.openqa.selenium.By;
import org.openqa.selenium.WebElement;
import org.testng.Assert;
import org.testng.annotations.AfterMethod;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Test;

import com.aventstack.extentreports.Status;

import base.BaseTest;
import utilities.CommenUtilities;


public class VerifyLoginFunctionality extends BaseTest{

	@BeforeMethod
	public void CreateReport(Method sTestMethod) {
		test = extent.createTest(sTestMethod.getName());
	}
	
	@AfterMethod
	public void CloseReport() {
	driver.close();
		
	}
	
	
	@Test
	public void VerifyLoginErrorMsg01() throws IOException, InterruptedException {
		//-------------//
		driver=getDriver("chrome");
		driver.get(oDataUtils.ReadWebElementProperties("App.URL"));
		Assert.assertEquals(driver.getCurrentUrl(), "Login | Salesforce");
		test.log(Status.INFO, "Application is launched");
		Thread.sleep(4000);
		
		//----------------//
		WebElement sUserName = driver.findElement(By.id(oDataUtils.ReadWebElementProperties("we.username.id")));
	if(	oCommonUtilities.waitForElementVisible(sUserName))
		sUserName.sendKeys(oDataUtils.ReadAccountProperties("prodaccount.name"));
	Assert.assertNotNull(sUserName.getText(), "maham.mar21@abc.com");
	test.log(Status.INFO, "Username is passed");
	Thread.sleep(5000);
	//----------------//
	WebElement sPassword = driver.findElement(By.id(oDataUtils.ReadWebElementProperties("we.password.id)")));
	if(	oCommonUtilities.waitForElementVisible(sPassword)) {
		sPassword.clear();
		test.log(Status.INFO, "password is empty");
	}
		//sPassword.sendKeys(oDataUtils.ReadAccountProperties("prodaccount.password"));
	Assert.assertNull(sPassword.getText(),"Failed: Password is not present");
	
	
	
	Thread.sleep(5000);
	//-----------------//
	WebElement sLoginButton = driver.findElement(By.xpath(oDataUtils.ReadWebElementProperties("we.login.xpath")));
	if(	oCommonUtilities.waitForElementVisible(sLoginButton))
		sLoginButton.click();
	
	
	//--------------//
	WebElement sErrorMsg = driver.findElement(By.xpath(oDataUtils.ReadWebElementProperties("we.errormsg.xpath")));
	Assert.assertEquals(sErrorMsg.getText(),oDataUtils.ReadWebElementProperties("login.errormsg"));
	
	if(sErrorMsg.getText().equals(oDataUtils.ReadWebElementProperties("login.errormsg"))) {
	test.pass("TC01 passed");
	}
	else
		test.addScreenCaptureFromPath(oCommonUtilities.takeScreenshot());
		test.fail("TC01 FAILED");
	
	}

}
